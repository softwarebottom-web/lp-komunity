<!DOCTYPE html>
<html lang="id">
<head><meta charset="UTF-8"><title>MARGA HQ</title><link rel="stylesheet" href="style.css"></head>
<body>
    <nav id="dynamic-nav"></nav>
    <div class="container">
        <h2 style="text-align:center; color:#ff0000;">FAMILY STRUCTURE</h2>
        <div id="structure-tree" class="glass-card" style="min-height:200px;">Loading...</div>

        <div class="grid-2">
            <div class="glass-card">
                <h3>ðŸ“‚ ARCHIVE BASE</h3>
                <div id="archive-list" style="height:200px; overflow-y:auto;"></div>
                
                <div id="founder-archive-panel" style="display:none; border-top:1px solid #333; margin-top:10px; padding-top:10px;">
                    <input type="text" id="arc-title" placeholder="Nama Base">
                    <input type="text" id="arc-url" placeholder="Link Data">
                    <input type="text" id="arc-desc" placeholder="Keterangan">
                    <button onclick="postArchive()" class="btn-primary" style="background:#ff4d4d;">ADD ARCHIVE</button>
                </div>
            </div>
            <div class="glass-card">
                <h3>ðŸ“» RADIO 101.9 FM</h3>
                <h1 style="color:#00f2ea; text-align:center;">ACTIVE</h1>
            </div>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="script.js"></script>
    <script>
        // Logic render archive & panel founder
        auth.onAuthStateChanged(async u => {
            if(u) {
                const s = await db.collection("users").doc(u.uid).get();
                if(s.data().role==="FOUNDER") document.getElementById('founder-archive-panel').style.display="block";
                
                db.collection("archives").orderBy("timestamp","desc").onSnapshot(ss => {
                    document.getElementById('archive-list').innerHTML = ss.docs.map(d=>
                        `<div style="margin-bottom:5px;"><a href="${d.data().url}" target="_blank" style="color:cyan">${d.data().title}</a></div>`
                    ).join('');
                });
            }
        });
    </script>
</body>
</html>
